{% extends "base.html" %} {% block title %}Saved{% endblock %} 

{% block content %}
    <div class="display-6 my-3" align="center">
        Saved Page
    </div>


    <div class="container">
      <div class="row">
        {% for drug in drugs %}
        <div class="col-sm-12 col-md-6">
          <div class="card-wrapper ">
            <div class="card shadow align-items-center" style="background-color:#CEE3EA;">
                <div class="card-body">
                    <div id="cardContainer" style="max-width:100%;">
                        <h4 class="card-title">{{ drug.name.replace("_", " ") }}</h4>
                        <div>
                            <h5 class="card-subtitle mb-2 text-body-secondary">Used For: {{ drug.disease }}</h5>
                            <br>
                            <div class="row">
                                <div class="col-sm-6 h6">
                                  Average Sex Distribution in Clinical Studies
                                </div>
                                
                                <!-- <div class="col-sm-6 h6">
                                  Disease Prevalence
                                </div> -->
                               
                            </div>
            
                            <div class="row ">
                              <div class="col-sm-12 d-flex justify-content-center">
                                <img class="card-sizing img-fluid" src="{{ drug.prevalence }}" alt="{{ drug.name }}">
                              </div>
                              <!-- <div class="col-sm-6">
                                <img style="height:auto;max-width:100%;display:block;" src="{{ drug.path_prevalence }}" alt="Disease Prevalence" >
                              </div> -->
                            </div>
                            <form action="{{ url_for('views.save_drug') if not drug.is_saved else url_for('views.unsave_drug') }}" method="post" class="mt-3">
                              
                              <div class="master">
                                <input type="hidden" name="drug_id" value="{{ drug.id }}">
                                {% if current_user.is_authenticated %}
                                <!-- If user is logged in, show the save/unsave button -->
                                  {% if drug.is_saved %}
                                      <button type = "submit" class="unsave-drug btn btn-start" data-drug="{{ drug.id }}">Unsave</button>
                                  {% else %}
                                      <button type = "submit" class="save-drug btn btn-start" data-drug="{{ drug.id }}">Save</button>
                                  {% endif %}
                                {% else %}
                                  <!-- If user is not logged in, show only the save button which redirects to login -->
                                  <a href="{{ url_for('auth.login') }}" class="btn btn-start">Save</a>
                                {% endif %}
                              </button>
                                <button hidden type="button" id="calcRisk" class="btn btn-start calcRisk" data-drug-id="{{ drug.id }}">Calculate Risk</button>  
                                <br><br>
                                <div id="resultString" class="container position-relative rounded " 
                                style="background-color: #CEE3EA; display:none;" data-drug-id="{{ drug.id }}">
                                
                                {{ result_strings }}
                                </div>
                              </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
            </div>
          <br>
        </div>
        {% endfor %}
      </div>
    </div>
    

    
   
    <!-- <script>
        window.onload = function() {
          var savedCard = localStorage.getItem('savedCard');
          if (savedCard) {
            document.getElementById('savedContainer').innerHTML += savedCard;
            document.getElementById('unsaveButton').addEventListener('click', function() {
              document.getElementById('savedContainer').innerHTML = '';
              localStorage.removeItem('savedCard');
              document.getElementById('cardContainer').style.display = 'none';
            });
          } else {
            document.getElementById('cardContainer').style.display = 'none';
          }
        };
    </script> -->
{% endblock %}